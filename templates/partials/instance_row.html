{{define "instance_row"}}
<div id="instance-{{.ID}}" class="instance-card" hx-get="/instances/{{.ID}}/status?s={{.Status}}" hx-trigger="every 10s" hx-swap="outerHTML">
    <div class="instance-card-header">
        <a href="/instances/{{.ID}}" class="instance-name">{{.Name}}</a>
        <span class="badge {{statusBadge .Status}}">{{.Status}}</span>
    </div>
    <div class="instance-card-body">
        <span class="instance-card-label mono">{{.ID}}</span>
        <span class="instance-card-label">{{if .MemoryMB}}{{.MemoryMB}}MB{{else}}∞{{end}} / {{if .CPUCores}}{{.CPUCores}}C{{else}}∞{{end}}</span>
        <span class="instance-card-label">{{.CreatedAt.Format "01-02 15:04"}}</span>
    </div>
    <div class="instance-card-footer">
        {{if eq .Status "running"}}
        <a href="javascript:void(0)" onclick="switchInstance('{{.ID}}')" class="btn btn-sm btn-success">Open</a>
        <a href="/instances/{{.ID}}/terminal" target="_blank" class="btn btn-sm btn-secondary" title="Terminal">Term</a>
        <button hx-post="/instances/{{.ID}}/stop"
                hx-target="#instance-{{.ID}}"
                hx-swap="outerHTML"
                hx-disabled-elt="this"
                class="btn btn-sm btn-warning"><span class="spinner"></span>Stop</button>
        <button hx-post="/instances/{{.ID}}/restart"
                hx-target="#instance-{{.ID}}"
                hx-swap="outerHTML"
                hx-disabled-elt="this"
                class="btn btn-sm btn-secondary"><span class="spinner"></span>Restart</button>
        {{else if or (eq .Status "stopped") (eq .Status "exited") (eq .Status "created") (eq .Status "error")}}
        <button hx-post="/instances/{{.ID}}/start"
                hx-target="#instance-{{.ID}}"
                hx-swap="outerHTML"
                hx-disabled-elt="this"
                class="btn btn-sm btn-primary"><span class="spinner"></span>Start</button>
        {{end}}
        <button onclick="openLogs('{{.ID}}')"
                class="btn btn-sm btn-secondary">Logs</button>
        <button hx-delete="/instances/{{.ID}}"
                hx-target="#instance-{{.ID}}"
                hx-swap="outerHTML"
                hx-disabled-elt="this"
                hx-confirm="Are you sure you want to delete instance '{{.Name}}'? This will destroy the container."
                class="btn btn-sm btn-danger"><span class="spinner"></span>Del</button>
    </div>
</div>
{{end}}
